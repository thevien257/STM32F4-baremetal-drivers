#include "stm32f4xx_cus.h"

uint32_t Get_APB1_Clock_Speed() {
	uint32_t ahb_prescaler_table[] = { 1, 1, 1, 1, 1, 1, 1, 1, 2, 4, 8, 16, 64,
			128, 256, 512 };
	uint32_t apb1_prescaler_table[] = { 1, 1, 1, 1, 2, 4, 8, 16 };
	uint8_t get_system_clock = (RCC->CFGR >> 2) & 0x3;
	uint8_t get_ahb_pres = (RCC->CFGR >> 4) & 0xF;
	uint8_t get_apb1_pres = (RCC->CFGR >> 10) & 0x7;
	if (get_system_clock == 0) {
		// HSI System Clock
		SystemClockSrc = (Clock_SRC / ahb_prescaler_table[get_ahb_pres])
				/ get_apb1_pres;

	} else if (get_system_clock == 1) {
		// // HSE System Clock
	} else if (get_system_clock == 2) {
		// PLL System Clock
	}
	return 0;
}
